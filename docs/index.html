<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Void Architecture</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f5f5f5; color:#333; padding:20px; }
    .container { max-width:600px; margin:0 auto; }
    video { width:100%; height:auto; margin-bottom:20px; background:#000; }
    input, button { width:100%; padding:8px; margin-top:5px; box-sizing:border-box; }
    label { margin-top:10px; display:block; }
    button { cursor:pointer; }
  </style>
</head>
<body>
  <div class="container">
    <video id="finalVideo" controls></video>
    <form id="sampleForm">
      <label for="contract">Ethereum Contract Address</label>
      <input type="text" id="contract" required />
      <label for="samples">Samples per file</label>
      <input type="number" id="samples" value="1" min="1" />
      <label for="duration">Clip duration (seconds)</label>
      <input type="number" id="duration" value="1" min="0.1" step="0.1" />
      <button type="submit">Generate Video</button>
    </form>
  </div>
  <script>
    async function loadLatestVideo() {
      const res = await fetch('/videos');
      if(res.ok) {
        const data = await res.json();
        if(data.video) {
          document.getElementById('finalVideo').src = '/videos/' + data.video;
        }
      }
    }

    document.getElementById('sampleForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const contract = document.getElementById('contract').value;
      const samples = document.getElementById('samples').value;
      const duration = document.getElementById('duration').value;
      const res = await fetch('/api/sample', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ contract, samples, duration })
      });
      if(res.ok) {
        const data = await res.json();
        if(data.video) {
          document.getElementById('finalVideo').src = '/videos/' + data.video;
        }
      } else {
        alert('Error generating video');
      }
    });

    loadLatestVideo();
  </script>
</body>
</html>
